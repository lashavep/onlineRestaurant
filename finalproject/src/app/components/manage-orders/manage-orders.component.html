<h2>{{ 'admin.manageOrders' | translate }}</h2>

<mat-accordion>
  <!-- Pending Orders -->
  <mat-expansion-panel [expanded]="true">
    <mat-expansion-panel-header>
      <mat-panel-title>{{ 'admin.pendingOrders' | translate }}</mat-panel-title>
    </mat-expansion-panel-header>

    <div *ngIf="pendingOrders.length > 0; else noPending">
      <div *ngFor="let order of pendingOrders" class="order-card pending-order">
        <p><strong>{{ 'admin.user' | translate }}:</strong> {{ order.user?.firstName }}</p>
        <p><strong>{{ 'admin.total' | translate }}:</strong> {{ order.total | currency: "₾" }}</p>
        <p><strong>{{ 'admin.date' | translate }}:</strong> {{ order.date | date:'short' }}</p>
        <p><strong>{{ 'admin.status' | translate }}:</strong> {{ order.status }}</p>

        <div class="order-actions">
          <button mat-button color="primary" *ngIf="order.status === 'Pending'" (click)="acceptOrder(order.id)">
            {{ 'admin.accept' | translate }}
          </button>
          <button mat-button color="warn" class="reject-btn" *ngIf="order.status === 'Pending'" (click)="rejectOrder(order.id)">
            {{ 'admin.reject' | translate }}
          </button>
          <button mat-button (click)="viewOrder(order)">{{ 'admin.view' | translate }}</button>
        </div>
      </div>

      <!-- ✅ Pending Pagination -->
      <div class="pagination">
        <button mat-button (click)="prevPendingPage()" [disabled]="pendingPage === 1">
          {{ 'admin.previous' | translate }}
        </button>
        <span>{{ 'admin.page' | translate }} {{ pendingPage }} / {{ pendingTotalPages }}</span>
        <button mat-button (click)="nextPendingPage()" [disabled]="pendingPage === pendingTotalPages">
          {{ 'admin.next' | translate }}
        </button>
      </div>
    </div>
    <ng-template #noPending>
      <p>{{ 'admin.noPendingOrders' | translate }}</p>
    </ng-template>
  </mat-expansion-panel>

  <!-- Completed Orders -->
  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>{{ 'admin.completedOrders' | translate }}</mat-panel-title>
    </mat-expansion-panel-header>

    <div *ngIf="completeOrders.length > 0; else noComplete">
      <div *ngFor="let order of completeOrders" class="order-card complete-order">
        <p><strong>{{ 'admin.user' | translate }}:</strong> {{ order.user?.firstName }}</p>
        <p><strong>{{ 'admin.total' | translate }}:</strong> {{ order.total | currency: "₾" }}</p>
        <p><strong>{{ 'admin.date' | translate }}:</strong> {{ order.date | date:'short' }}</p>
        <p><strong>{{ 'admin.status' | translate }}:</strong> {{ order.status }}</p>
        <button mat-button (click)="viewOrder(order)">{{ 'admin.view' | translate }}</button>
      </div>

      <!-- ✅ Completed Pagination -->
      <div class="pagination">
        <button mat-button (click)="prevCompletePage()" [disabled]="completePage === 1">
          {{ 'admin.previous' | translate }}
        </button>
        <span>{{ 'admin.page' | translate }} {{ completePage }} / {{ completeTotalPages }}</span>
        <button mat-button (click)="nextCompletePage()" [disabled]="completePage === completeTotalPages">
          {{ 'admin.next' | translate }}
        </button>
      </div>
    </div>
    <ng-template #noComplete>
      <p>{{ 'admin.noCompletedOrders' | translate }}</p>
    </ng-template>
  </mat-expansion-panel>

  <!-- Rejected Orders -->
  <mat-expansion-panel>
    <mat-expansion-panel-header>
      <mat-panel-title>{{ 'admin.rejectedOrders' | translate }}</mat-panel-title>
    </mat-expansion-panel-header>

    <div *ngIf="rejectedOrders.length > 0; else noRejected">
      <div *ngFor="let order of rejectedOrders" class="order-card rejected-order">
        <p><strong>{{ 'admin.user' | translate }}:</strong> {{ order.user?.firstName }}</p>
        <p><strong>{{ 'admin.total' | translate }}:</strong> {{ order.total | currency: "₾" }}</p>
        <p><strong>{{ 'admin.date' | translate }}:</strong> {{ order.date | date:'short' }}</p>
        <p><strong>{{ 'admin.status' | translate }}:</strong> {{ order.status }}</p>
        <button mat-button (click)="viewOrder(order)">{{ 'admin.view' | translate }}</button>
      </div>


      <div class="pagination">
        <button mat-button (click)="prevRejectedPage()" [disabled]="rejectedPage === 1">
          {{ 'admin.previous' | translate }}
        </button>
        <span>{{ 'admin.page' | translate }} {{ rejectedPage }} / {{ rejectedTotalPages }}</span>
        <button mat-button (click)="nextRejectedPage()" [disabled]="rejectedPage === rejectedTotalPages">
          {{ 'admin.next' | translate }}
        </button>
      </div>
    </div>
    <ng-template #noRejected>
      <p>{{ 'admin.noRejectedOrders' | translate }}</p>
    </ng-template>
  </mat-expansion-panel>
</mat-accordion>